# ============================================================
# BrewBridge Migration Manifest Template
# ============================================================
# This manifest defines the pipelines to migrate from Platform 3.0 to Platform 4.0
# 
# Usage:
#   1. Copy this template to your project root or migration directory
#   2. Fill in the pipeline details and credentials
#   3. Run: uv run python scripts/setup_test.py manifest.yaml
# ============================================================

# List of pipelines to migrate
# Each pipeline should have:
#   - name: Unique identifier for the pipeline
#   - repo: GitHub repository (format: owner/repo-name)
#   - path: Path to the pipeline definition file within the repo
#   - branch: (optional) Branch name, defaults to "main"
#   - environment_type: (optional) "brz", "slv", or "gld"
#   - normalized_schema_v4: (optional) Schema data matching Platform 4.0 structure
pipelines_to_migrate:
  # Example 1: Bronze/Silver ingestion pipeline (Hopsflow)
  - name: test_ingestion_x
    repo: BrewDat/brewdat-maz-maz-tech-sap-repo-adf
    path: pipelines/ingestion/pipeline1.json
    branch: main  # Optional, defaults to "main"
    environment_type: brz  # Optional: brz, slv, or gld
    normalized_schema_v4:  # Optional: Pre-defined schema
      zone: maz
      landing_zone: maz
      domain: logistics
      pipeline: test_ingestion_x
      schedule: "* * 2 * *"
      table_name: raw_logistics_orders
      owner: platform
      connector: blob
      source_system: sap-test
      source_entity: sap-test
      target_entity: sap-test
      connection_id: sap-test-secret
      transformations: ""
      acl: yn
  
  # Example 2: Gold transformation pipeline (Brewtiful)
  - name: test_pipeline_x
    repo: BrewDat/example-source-repo
    path: pipelines/transformation/pipeline2.json
    branch: develop  # Optional
    environment_type: gld  # Gold environment
    normalized_schema_v4:  # Optional: Pre-defined schema
      zone: maz
      landing_zone: maz
      country: co
      domain: sales
      owner: platform
      schedule: "* * 2 * *"
      table_scope: transformation
      data_product_subdomain: promo
      table_name: test_table
      acl: y
      trigger: n

# Credentials can be provided here or via environment variables
# Environment variables take precedence over manifest credentials
# 
# Recommended: Use environment variables for sensitive credentials
# and only include non-sensitive metadata here
credentials:
  # GitHub Personal Access Token (required)
  # Can also be set via: GITHUB_TOKEN environment variable
  GITHUB_TOKEN: "your_github_token_here"
  
  # Azure Data Factory credentials (optional)
  # Can also be set via: ADF_TENANT_ID, ADF_CLIENT_ID, ADF_CLIENT_SECRET
  ADF_TENANT_ID: "your_azure_tenant_id"
  ADF_CLIENT_ID: "your_azure_client_id"
  ADF_CLIENT_SECRET: "your_azure_client_secret"
  
  # LLM API credentials (optional)
  # Asimov API
  ASIMOV_URL: "https://your-asimov-instance.com"
  ASIMOV_PRODUCT_TOKEN: "your_asimov_token"
  
  # OpenAI API (alternative to Asimov)
  # OPENAI_API_KEY: "your_openai_api_key"

# Metadata (optional)
region: "us-east-1"  # AWS region or Azure region
environment: "dev"    # Environment: dev, staging, prod
repo_name: "BrewDat/source-repo"           # Source repository name
target_repo_name: "BrewDat/target-repo-4.0"  # Target repository for Platform 4.0

# ============================================================
# Example with minimal configuration:
# ============================================================
# pipelines_to_migrate:
#   - name: my_pipeline
#     repo: MyOrg/my-repo
#     path: pipelines/my_pipeline.json
# 
# credentials:
#   GITHUB_TOKEN: "${GITHUB_TOKEN}"  # Reference env var
# ============================================================

